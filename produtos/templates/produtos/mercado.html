{% extends 'produtos/base.html' %} {% load humanize %} {% block title %}ItemShop
- Loja{% endblock %} {% block extra_css %}
<style>
  .card-product {
    border: none;
    border-radius: 15px;
    transition: all 0.3s ease;
    background-color: #343a40;
    position: relative;
    overflow: hidden;
    min-height: 360px;
  }
  .card-product:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
  }
  .card-product .card-body {
    position: relative;
    z-index: 2;
    color: white;
    display: flex;
    flex-direction: column;
    height: 100%;
  }
  .btn-buy {
    background-color: #10b981; /* Verde Esmeralda */
    border: none;
    font-weight: 500;
    color: white;
  }
  .btn-buy:hover {
    background-color: #059669;
    color: white;
  }
  .badge-price {
    font-size: 0.9rem;
    background-color: #e9ecef;
    color: #1a237e;
    font-weight: 700;
  }
</style>
{% endblock %} {% block content %}
<div class="container py-5">
  <div class="row">
    <!-- Lista de Produtos -->
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h2 class="fw-bold text-dark mb-0">Mercado Global</h2>
          <p class="text-muted">Explore itens únicos de outros jogadores</p>
        </div>
        <span class="badge bg-primary rounded-pill"
          >{{ produtos.count }} Itens</span
        >
      </div>

      <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4">
        {% for produto in produtos %}
        <div class="col">
          <div class="card card-product shadow-sm h-100">
            <!-- Imagem de Fundo -->
            {% if produto.imagem %}
            <div
              class="bg-image"
              style="background-image: url('{{ produto.imagem.url }}');"
            ></div>
            {% else %}
            <div class="bg-fallback"></div>
            {% endif %}

            <!-- Overlay Escuro -->
            <div class="card-overlay"></div>

            <div class="card-body d-flex flex-column">
              <!-- Conteúdo -->
              <div class="mt-auto">
                <h6 class="card-title fw-bold text-white text-shadow mb-1">
                  {{ produto.nome }}
                </h6>
                <p class="card-text text-white-50" style="font-size: 0.8rem">
                  {{ produto.descricao|truncatechars:60 }}
                </p>
              </div>

              <div
                class="d-flex justify-content-between align-items-center mb-3"
              >
                <span class="badge badge-price rounded-pill"
                  >R$ {{ produto.preco|intcomma }}</span
                >
                <small class="text-white-50" style="font-size: 0.75rem"
                  ><i class="fas fa-user me-1"></i
                  >{{produto.dono.username}}</small
                >
              </div>
              {% if user.is_authenticated and produto.dono == user %}
              <button class="btn btn-secondary w-100 disabled" disabled>
                <i class="fas fa-user-check me-2"></i>Seu Item
              </button>
              {% else %}
              <form
                action="{% url 'comprar_produto' produto.id %}"
                method="post"
              >
                {% csrf_token %}<button
                  type="submit"
                  class="btn btn-buy w-100 shadow-sm"
                >
                  <i class="fas fa-shopping-cart me-2"></i>Comprar
                </button>
              </form>
              {% endif %}
            </div>
          </div>
        </div>
        {% empty %}
        <div class="col-12 text-center py-5">
          <div class="text-muted">
            <i class="fas fa-box-open fa-4x mb-3"></i>
            <h4>O mercado está vazio!</h4>
            <p>Seja o primeiro a colocar algo à venda.</p>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
